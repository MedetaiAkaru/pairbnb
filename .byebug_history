c
params
c
params[:price]
c
params[:payment_method_nonce]
params[:price]
c
params[:price]
params[:price][value]
params[:price].value
params[:price]
amount
c
amount
@result
c
n
c
@reservation.total
@reservation
c
@reservation
c
@reservation.total
c
params
c
@reservation
c
User.all
Payment.all
Payments.all
payments
Payments
newpayment.save
newpayment
n
c
Payment.all
Payments.all
n
c
@result.transaction.id
@result.id
@result
c
n
c
current_user.update(braintree_customer_id: @result.transaction.customer_details.id)
current_user
current_user.errors.full_messages
n
c
current_user.has_payment_info?
current_user.has_payment_info?>
@result.transaction.customer_details.id
current_user.braintree_customer_id
user.braintree_customer_id
cls
current_user.update(braintree_customer_id: @result.transaction.customer_details.id)
c
@result.transaction.customer_details.id
@result.transaction.customer_details_id
@result.transaction
@result
n
c
@result
n
c
n
@result
n
current_user
c
n
@result.success?
@result
n
current_user.has_payment_info?
current_user
@result
c
@result
n
current_user
c
n
signed_in?
n
signed_in?
n
signed_in?
c
render json: reservations
reservations
json
c
@listing.user
c
@listing
@listing.user
@listing
c
user
c
n
sign_in
sign_in(user)
user
